<ion-header>
  <ion-toolbar class="custom-toolbar">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title class="custom-title">Stronks</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="logout()" class="custom-button">
        <ion-icon name="log-out-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<div class="balance-container">
  <ion-card class="balance-card custom-card">
    <ion-card-header class="custom-card-header">
      <ion-card-subtitle class="custom-subtitle">Verf√ºgbar</ion-card-subtitle>
      <ion-card-title class="custom-title">
        {{ accountBalance | currency:'USD':'symbol':'1.2-2' }}
      </ion-card-title>
    </ion-card-header>
  </ion-card>

  <ion-card class="balance-card custom-card">
    <ion-card-header class="custom-card-header">
      <ion-card-subtitle class="custom-subtitle"
        >Portfoliowert</ion-card-subtitle
      >
      <ion-card-title class="custom-title">
        {{ portfolioValue | currency:'USD':'symbol':'1.2-2' }}
        <span
          [ngClass]="{'positive-color': profitLossPercentage > 0, 'negative-color': profitLossPercentage < 0}"
        >
          ({{ profitLossPercentage | number:'1.2-2' }}%)
        </span>
      </ion-card-title>
      <ion-note
        [ngClass]="{'positive-color': profitLoss > 0, 'negative-color': profitLoss < 0}"
        class="custom-note"
      >
        {{ profitLoss >= 0 ? '+' : ''}}{{ profitLoss |
        currency:'USD':'symbol':'1.2-2' }}
      </ion-note>
    </ion-card-header>
  </ion-card>
</div>

<ion-content class="ion-padding custom-content">
  <div class="cards-container">
    <ion-card class="investment-card custom-card">
      <ion-card-header class="custom-card-header">
        <ion-card-subtitle class="custom-subtitle"
          >Investitionen</ion-card-subtitle
        >
      </ion-card-header>

      <ion-card-content class="custom-card-content">
        <!-- Zeige nur eine kompakte, klare Zusammenfassung ohne Toggle-Buttons -->
        <div>
          <p>Aktive Positionen: {{ userInvestments?.length || 0 }}</p>
          <ion-button fill="clear" (click)="loadPortfolio()">
            Aktualisieren
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>

<!-- Trade Popup Modal -->
<ion-modal [isOpen]="showTradePopup" (didDismiss)="closeTradePopup()">
  <ng-template>
    <app-trade-popup
      [action]="tradeAction"
      [assetSymbol]="'BTC-USD'"
      [assetName]="'Bitcoin'"
      [currentPrice]="currentPrice"
      [userBalance]="accountBalance"
      [availableQuantity]="getBitcoinQuantity()"
      (close)="closeTradePopup()"
      (tradeCompleted)="onTradeCompleted($event)"
    ></app-trade-popup>
  </ng-template>
</ion-modal>
